# 太陽系ベース宇宙分割システム設計書

## 概要
宇宙を太陽系単位で分割し、各惑星エリアを独立した空間として管理する。

## 基本構造

### 1. 太陽系の構成
```
太陽系 (Solar System)
├── 水星エリア (Mercury Zone)
├── 金星エリア (Venus Zone)
├── 地球エリア (Earth Zone)
├── 火星エリア (Mars Zone)
├── 木星エリア (Jupiter Zone)
└── 外宇宙ゲート (Outer Space Gate) ※将来拡張用
```

### 2. エリアの仕様

#### 各惑星エリア
- **サイズ**: 半径 5,000～10,000 ユニット
- **中心**: 主惑星
- **内容**:
  - 主惑星 (メイン)
  - 衛星 (0～4個)
  - 小惑星帯
  - 宇宙ステーション
  - ワープゲート (他エリアへの接続点)
  - 隠し惑星/オブジェクト

#### エリア間移動
- ワープゲートを通じて移動
- エネルギー消費 (距離に応じて)
- ローディング中に次エリアを準備

### 3. 技術実装

#### ゾーンマネージャー
```javascript
class ZoneManager {
    zones = {
        mercury: { id: 'mercury', name: '水星エリア', position: 1 },
        venus: { id: 'venus', name: '金星エリア', position: 2 },
        earth: { id: 'earth', name: '地球エリア', position: 3 },
        mars: { id: 'mars', name: '火星エリア', position: 4 },
        jupiter: { id: 'jupiter', name: '木星エリア', position: 5 }
    }
    
    currentZone = 'earth'
    loadedZones = new Set(['earth'])
}
```

#### メモリ管理
- 現在のゾーンとその隣接ゾーンのみロード
- 離れたゾーンはアンロード
- オブジェクトプーリングで再利用

### 4. マルチプレイヤー対応

#### インスタンス方式
- 各エリアは最大20～50人
- 満員時は新インスタンス生成
- フレンドは同一インスタンスに優先配置

#### 同期範囲
- 同一エリア内のプレイヤーのみ同期
- エリア移動時に同期切り替え
- チャットは全エリア共通 (オプション)

### 5. 新惑星発見システム

#### 探索メカニズム
- 各エリアに未発見エリアが存在
- スキャンで発見確率上昇
- 特定条件で出現 (時間、クエスト等)

#### 惑星タイプ
1. **通常惑星**: 資源採掘、基地建設可能
2. **特殊惑星**: レア資源、特殊イベント
3. **謎の惑星**: ストーリー進行に必要
4. **プレイヤー惑星**: 他プレイヤーが開発した惑星

### 6. 拡張性

#### 外宇宙への展開
- 木星エリアに「外宇宙ゲート」設置
- 条件達成で新太陽系へアクセス
- 各太陽系は独自のテーマ/難易度

#### 追加可能な要素
- 彗星 (期間限定イベント)
- ブラックホール (ショートカット)
- 宇宙海賊の基地
- 異星人の遺跡

### 7. UI/UX

#### ゾーンマップ
- 太陽系全体図
- 現在位置表示
- 発見済みエリア表示
- ワープルート表示

#### 移動UI
- ワープゲート接近で表示
- 行き先選択メニュー
- 必要エネルギー表示
- 到着予想時間

### 8. パフォーマンス最適化

#### LODシステム
- 遠距離オブジェクトは簡易表示
- 惑星は距離に応じて詳細度変更
- 見えないオブジェクトは非描画

#### ストリーミング
- バックグラウンドで次エリアを先読み
- シームレスな移動体験
- 優先度に基づくロード順序

## 実装優先順位

1. **Phase 1**: ゾーンマネージャーとエリア切り替え
2. **Phase 2**: ワープゲートシステム
3. **Phase 3**: 動的ロード/アンロード
4. **Phase 4**: 新惑星発見システム
5. **Phase 5**: マルチプレイヤー対応
6. **Phase 6**: 外宇宙拡張