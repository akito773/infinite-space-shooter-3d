# レイド戦・球体空間戦闘システム設計書

## 概要
通常の2.5D平面探索から、特別なレイド戦では完全3D球体空間での戦闘に移行。
ジャミングや位置情報共有などの戦術要素を加えた、宇宙らしい戦闘体験を提供。

## 球体戦闘空間

### 基本構造
```
中心: レイドボス
半径: 1,000～3,000ユニット（ボスサイズに応じて）
プレイヤー配置: 球面上のランダム位置
重力: 中心に向かう弱い引力（オプション）
```

### 空間の特性
- **視界制限**: 球の反対側は見えない
- **通信遅延**: 距離に応じた情報遅延
- **エネルギーフィールド**: 球体外に出られない

## ジャミングシステム

### ボスのジャミング能力
1. **レーダージャミング**
   - 一定時間レーダーを無効化
   - 視認のみでの戦闘を強制
   - 「電磁パルス発生！レーダーシステムダウン！」

2. **通信妨害**
   - チームチャットに遅延やノイズ
   - 位置情報の更新頻度低下
   - 音声通信に静電ノイズ効果

3. **視覚妨害**
   - ホログラム分身を生成
   - 光学迷彩で一時的に消失
   - 強烈なフラッシュで一時的な視界障害

### プレイヤーの対抗手段
- **信号ブイ投下**: 手動で位置マーカーを設置
- **レーザー通信**: ジャミング耐性のある直線通信
- **アナログ計器**: 基本的な方位磁針は機能

## 位置情報共有システム

### 通常時の情報共有
```javascript
// リアルタイム位置共有
{
    playerId: "player1",
    position: {x, y, z},
    heading: {x, y, z},
    health: 80,
    status: "engaging",
    target: "boss_weakpoint_3"
}
```

### ジャミング時の制限
- 位置更新: 5秒遅延
- 精度低下: ±50ユニットの誤差
- 断片的な通信: "...撃中...援護を..."

### 戦術的コミュニケーション
1. **ピンシステム**
   - 3D空間にマーカーを配置
   - 「ここを攻撃」「危険」「集合」

2. **ビーコン**
   - 自機の位置を強調表示（エネルギー消費）
   - 味方全員に即座に伝達

3. **編隊指示**
   - リーダーが編隊パターンを指定
   - 自動的に隊形を維持

## PvPモード応用

### チーム戦（4v4、8v8）
- **攻撃側**: 中心の基地/旗を制圧
- **防衛側**: 一定時間防衛
- ジャミング装置の奪い合い

### バトルロイヤル
- 球体が徐々に収縮
- 最後まで生き残ったプレイヤーが勝利
- 補給ポッドがランダムに出現

### キャプチャー・ザ・フラグ
- 球体の両極に旗を配置
- 3D空間での駆け引き
- ジャミングで敵の連携を妨害

## 特殊演出

### レイド開始時
```
1. 通常空間から急激にズームアウト
2. 巨大な球体フィールドが展開
3. 「警告：強力な重力場検出」
4. BGMが壮大なオーケストラに変化
```

### ジャミング発動演出
- 画面にノイズエフェクト
- UIが一時的に乱れる
- 警告音とアラート表示
- 「システム障害...再起動中...」

### 位置共有演出
- レーザービームで味方を視覚的に接続
- ホログラムで味方の状態を表示
- 音声通信時に波形表示

## 実装における利点

### 技術面
- レイド時のみ高負荷処理
- 明確な戦闘エリア制限
- プレイヤー数の管理が容易

### ゲームプレイ
- 通常探索との明確な差別化
- 高い戦術性と協力要素
- 宇宙戦闘の臨場感

### 拡張性
- 新しいジャミングパターン追加可能
- 様々なPvPモードに応用
- e-Sports向けの観戦機能

## UI特別対応

### レイド専用HUD
```
[3Dレーダー]     [チーム状態]
     球体表示        HP/位置

[ジャミング状態インジケーター]
■■■□□ (残り時間)

[高度/方位計]    [通信状態]
  アナログ表示     ノイズレベル
```

### 戦術マップ（Tabキー）
- 球体を外から見た俯瞰図
- 最後に確認された味方位置
- 予測軌道の表示

これにより、普段の探索は快適な2.5Dで、特別な戦闘では本格的な3D宇宙戦闘を楽しめます！